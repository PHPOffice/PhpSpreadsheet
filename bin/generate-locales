#!/usr/bin/env php
<?php

use PhpOffice\PhpSpreadsheet\Calculation\Calculation;
use PhpOffice\PhpSpreadsheetInfra\LocaleGenerator;

require_once 'vendor/autoload.php';

try {
    $phpSpreadsheetFunctions = Calculation::getInstance()->getFunctions();

    $localeGenerator = new LocaleGenerator(
        realpath(__DIR__ . '/../src/PhpSpreadsheet/Calculation/locale/'),
        'Translations.xlsx',
        $phpSpreadsheetFunctions,
        true
    );
    $localeGenerator->generateLocales();
} catch (\Exception $e) {
    fwrite(STDERR, (string) $e);
    exit(1);
}
